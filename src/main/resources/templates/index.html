<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카페 페키지</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fff5ec;
        }

        .header {
            background-color: #f9e5cf;
            display: flex;
            justify-content: space-between;
            padding: 10px 20px;
            align-items: center;
            border-bottom: 1px solid #e0d0c1;
        }

        .header-left {
            font-weight: bold;
        }

        .header-right {
            display: flex;
            gap: 30px;
        }

        .main-container {
            display: flex;
            height: calc(100vh - 190px);
        }


        .left-panel {
            width: 450px;
            background-color: #fff;
            border-right: 1px solid #e0d0c1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .menu-tabs {
            background-color: #ffd7d7;
            display: flex;
            border-bottom: 1px solid #e0d0c1;
        }

        .tab {
            padding: 10px 20px;
            text-align: center;
            flex: 1;
            border-right: 1px solid #e0d0c1;
        }

        .order-list {
            flex: 1;
            overflow: hidden;
        }

        .total-section {
            background-color: #f9f9f9;
            padding: 10px;
            border-top: 1px solid #e0d0c1;
        }

        .total-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }

        .button-row {
            display: flex;
            gap: 5px;
            padding: 5px;
            background-color: white;
        }

        .button {
            flex: 1;
            padding: 10px;
            background-color: #ffe5e5;
            border: 1px solid #e0d0c1;
            text-align: center;
            cursor: pointer;
        }

        .right-panel {
            flex: 1;
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            grid-auto-rows: minmax(60px, auto);
            overflow: hidden;
        }

        .category-row {
            grid-column: 1 / span 7;
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .category-button {
            flex: 1;
            background-color: #ffbdbd;
            padding: 10px;
            text-align: center;
            border-radius: 3px;
            cursor: pointer;
        }

        .menu-item {
            background-color: #ffecd9;
            padding: 10px;
            text-align: center;
            border-radius: 3px;
            cursor: pointer;
        }

        .footer {
            bottom: 0;
            left: 0;
            display: flex;
            width: 100%;
            height: 60px;
            z-index: 1000;
        }

        .footer-button {
            flex: 1;
            text-align: center;
            padding: 20px 0;
            cursor: pointer;
            button:focus {
                outline: none;
            }
        }

        .footer-button.pink {
            background-color: #ffd7d7;
        }

        .footer-button.green {
            background-color: #d7ffd7;
        }

        .footer-button.blue {
            background-color: #d7e5ff;
        }

        .operation-button {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ffe5e5;
            cursor: pointer;
        }

        #clock {
            font-size: 1em;
            font-weight: bold;
            color: #333;
        }

        /* Sales UI 스타일 추가 */
        .sales-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            max-width: 700px;
            width: 90%;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
        }

        /* Sales UI 추가 스타일 */
        .sales-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        .date-selector {
            display: flex;
            align-items: center;
        }

        .date-input {
            padding: 5px;
            border: 1px solid #ddd;
            margin-right: 10px;
        }

        .calendar-icon {
            width: 30px;
            height: 30px;
            background-color: #c25555;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .close-btn {
            cursor: pointer;
            font-size: 20px;
        }

        .sales-tab-container {
            display: flex;
            border-bottom: 1px solid #ddd;
        }

        .sales-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            cursor: pointer;
            background-color: #fcf0f0;
            border: 1px solid #ffd7d7;
        }

        .sales-tab.active {
            background-color: #ffd7d7;
        }

        .sales-scrollable-container {
            max-height: 500px;
            overflow-y: auto;
        }

        .sales-table {
            width: 100%;
            border-collapse: collapse;
        }

        .sales-table th {
            background-color: #ffd7d7;
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .sales-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .time-cell {
            font-weight: bold;
        }

        .sales-footer {
            display: flex;
            padding: 10px;
            gap: 5px;
            justify-content: space-between;
        }

        .sales-footer-button {
            flex: 1;
            padding: 10px;
            text-align: center;
            background-color: #ffd7d7;
            border: 1px solid #ddd;
            cursor: pointer;
        }

        /* 메뉴 관리 모달 스타일 */
        .menu-manage-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .menu-manage-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 1000px;
            background: white;
            border-radius: 8px;
            z-index: 1001;
            padding: 20px;
        }

        .menu-manage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .menu-manage-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .menu-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .menu-form input,
        .menu-form textarea,
        .menu-form select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .menu-table-container {
            overflow-y: auto;
            max-height: 500px;
        }

        .menu-table {
            width: 100%;
            border-collapse: collapse;
        }

        .menu-table th,
        .menu-table td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .menu-table th {
            background-color: #f5f5f5;
        }

        /* 메뉴 수정 모달 스타일 */
        .menu-edit-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 8px;
            z-index: 1002;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .menu-edit-modal form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .category-button.active {
            background-color: #ff9999;
        }

        /* 공통 모달 스타일 */
        .menu-manage-overlay,
        .category-manage-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .menu-manage-container,
        .category-manage-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 1000px;
            background: white;
            border-radius: 8px;
            z-index: 1001;
            padding: 20px;
        }

        .menu-manage-header,
        .category-manage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .menu-manage-content,
        .category-manage-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .menu-form,
        .category-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .menu-form input,
        .menu-form textarea,
        .menu-form select,
        .category-form input,
        .category-form textarea,
        .category-form select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .menu-table-container,
        .category-table-container {
            overflow-y: auto;
            max-height: 500px;
        }

        .menu-table,
        .category-table {
            width: 100%;
            border-collapse: collapse;
        }

        .menu-table th,
        .menu-table td,
        .category-table th,
        .category-table td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: left;
        }

        .menu-table th,
        .category-table th {
            background-color: #f5f5f5;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #ff0000;
        }

        button {
            padding: 8px 16px;
            background-color: #ffd7d7;
            border: 1px solid #ffb3b3;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #ffb3b3;
        }
    </style>
</head>
<body>
<div class="header">
    <div class="header-left">
        <div>회사명</div>
        <ul>
            <li>날짜 및 시간 : <a id="clock" ></a></li>
            <li>관리자</li>
        </ul>
        <script>
            function updateClock() {
                const now = new Date();
                const day = now.getDate();
                const month = now.getMonth() + 1;
                const year = now.getFullYear();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const timeString = `${year}-${month}-${day}/${hours}:${minutes}:${seconds}`;
                document.getElementById('clock').textContent = timeString;
            }
            updateClock();
            setInterval(updateClock, 500);
        </script>
    </div>
    <div class="header-right">
        <div onclick="showSalesUI()">매출</div>
        <div>재고</div>
        <div>직원</div>
        <div>설정</div>
        <div>-</div>
        <div>X</div>
    </div>
</div>

<div class="main-container">
    <div class="left-panel">
        <div class="menu-tabs">
            <div class="tab">번호</div>
            <div class="tab">메뉴</div>
            <div class="tab">수량</div>
            <div class="tab">가격</div>
        </div>

        <div class="order-list">
            <!-- Order items will go here -->
        </div>

        <div class="total-section">
            <div class="total-item">
                <div class="button">바코드</div>
                <div class="button">상품검색</div>
                <div class="button">주문상세</div>
                <div class="button">위</div>
                <div class="button">위</div>
            </div>
            <div class="total-item">
                <div>주문금액</div>
                <div>0</div>
                <div>청구금액</div>
            </div>
            <div class="total-item">
                <div>서비스</div>
                <div>0</div>
            </div>
            <div class="total-item">
                <div>할인금액</div>
                <div>0</div>
                <div>주문수량</div>
            </div>
            <div class="total-item">
                <div>봉사료</div>
                <div>0</div>
            </div>
        </div>

        <div class="button-row">
            <div class="button"></div>
            <div class="button"></div>
            <div class="button"></div>
            <div class="operation-button">+</div>
            <div class="operation-button">-</div>
        </div>
    </div>

    <div class="right-panel">
        <div class="category-row">
            <div class="category-button" data-category="COFFEE">커피</div>
            <div class="category-button" data-category="DECAF">디카페인</div>
            <div class="category-button" data-category="NON_COFFEE">논커피/<br>과일라떼</div>
            <div class="category-button" data-category="TEA">티</div>
            <div class="category-button" data-category="SMOOTHIE">스무디<br>프라페</div>
            <div class="category-button" data-category="ADE">에이드<br>주스</div>
            <div class="category-button" onclick="openCategoryManageModal()">카테고리<br>관리</div>
        </div>

        <div class="category-row">
            <div class="category-button" data-category="SEASON">시즌메뉴</div>
            <div class="category-button" data-category="BREAD">빵</div>
            <div class="category-button"></div>
            <div class="category-button"></div>
            <div class="category-button"></div>
            <div class="category-button"></div>
            <div class="category-button" onclick="openMenuManageModal()">메뉴<br>관리</div>
        </div>

        <!-- Menu items grid, 7x8 grid -->
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>

        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
        <div class="menu-item"></div>
    </div>
</div>
<div class="footer">
    <div class="footer-button"></div>
    <div class="footer-button pink">회원 검색</div>
    <div class="footer-button pink">반품</div>
    <div class="footer-button pink"></div>
    <div class="footer-button green">분할</div>
    <div class="footer-button green">복합</div>
    <div class="footer-button blue">현금</div>
    <div class="footer-button blue">카드</div>
</div>

<!-- Sales UI 오버레이 -->
<div class="overlay"></div>

<!-- Sales UI -->
<div class="sales-container">
    <div class="sales-header">
        <div class="date-selector">
            <input type="date" class="date-input" value="2025-04-04">
            <div class="calendar-icon">17</div>
        </div>
        <div class="close-btn">✕</div>
    </div>

    <div class="sales-tab-container">
        <div class="sales-tab active">일별(시간대별)</div>
        <div class="sales-tab">월별</div>
        <div class="sales-tab">년도별</div>
    </div>

    <div class="sales-scrollable-container">
        <table class="sales-table">
            <thead>
            <tr>
                <th>시간</th>
                <th>현금</th>
                <th>카드</th>
                <th>포인트</th>
                <th>기타</th>
            </tr>
            </thead>
            <tbody>
            <!-- 00시부터 21시까지의 행 -->
            <tr>
                <td class="time-cell">00시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <!-- 나머지 시간대 행들 (01시~21시) -->
            <tr>
                <td class="time-cell">01시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <!-- 02시부터 20시까지 동일한 구조로 반복 -->
            <tr>
                <td class="time-cell">02시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">03시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">04시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">05시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">06시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">07시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">08시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">09시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">10시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">11시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">12시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">13시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">14시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">15시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">16시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">17시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">18시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">19시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">20시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td class="time-cell">21시</td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            </tbody>
        </table>
    </div> <!-- 매출 화면 -->

    <div class="sales-footer">
        <div class="sales-footer-button">현금</div>
        <div class="sales-footer-button">카드</div>
        <div class="sales-footer-button">포인트</div>
        <div class="sales-footer-button">기타</div>
        <div class="sales-footer-button">총매출</div>
    </div>
</div>
<!-- Sales UI 제어 및 데이터 통신 -->
<script>
    function showSalesUI() {
        document.querySelector('.overlay').style.display = 'block';
        document.querySelector('.sales-container').style.display = 'block';
    }

    // 닫기 버튼 이벤트
    document.querySelector('.close-btn').addEventListener('click', function() {
        document.querySelector('.overlay').style.display = 'none';
        document.querySelector('.sales-container').style.display = 'none';
    });

    // 오버레이 클릭 시 닫기
    document.querySelector('.overlay').addEventListener('click', function() {
        document.querySelector('.overlay').style.display = 'none';
        document.querySelector('.sales-container').style.display = 'none';
    });

    // Sales 탭 전환 기능
    const salesTabs = document.querySelectorAll('.sales-tab');
    salesTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            salesTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // 날짜 입력 시 자동 업데이트
    document.querySelector('.date-input').addEventListener('change', function(e) {
        // 여기에 날짜 변경 시 처리할 로직 추가(예정)
        console.log('Selected date:', e.target.value);
    });
</script>
<!-- 메뉴 업데이트 로직 -->
<script>
    // 메뉴 관리 모달 열기
    function openMenuManageModal() {
        document.querySelector('.menu-manage-overlay').style.display = 'block';
        document.querySelector('.menu-manage-container').style.display = 'block';
        loadMenus();
        loadCategoriesForSelect();
    }

    // 메뉴 관리 모달 닫기
    function closeMenuManageModal() {
        document.querySelector('.menu-manage-overlay').style.display = 'none';
        document.querySelector('.menu-manage-container').style.display = 'none';
    }

    // 메뉴 로드 함수 - API 연동
    async function loadMenus() {
        try {
            const response = await fetch('/api/menus');
            const menus = await response.json();
            
            const menuTableBody = document.querySelector('.menu-table tbody');
            menuTableBody.innerHTML = '';
            
            menus.forEach(menu => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${menu.name}</td>
                    <td>${menu.price}원</td>
                    <td>${menu.category.name}</td>
                    <td>${menu.description || ''}</td>
                    <td>${menu.available ? '판매중' : '판매중지'}</td>
                    <td>
                        <button onclick="editMenu(${menu.id})">수정</button>
                        <button onclick="deleteMenu(${menu.id})">삭제</button>
                    </td>
                `;
                menuTableBody.appendChild(row);
            });
        } catch (error) {
            console.error('메뉴 로드 중 오류 발생:', error);
        }
    }

    // 메뉴 추가 함수
    async function addMenu(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const menuData = {
            name: formData.get('name'),
            price: parseInt(formData.get('price')),
            category: { id: parseInt(formData.get('category')) },
            description: formData.get('description'),
            available: formData.get('available') === 'true'
        };

        try {
            const response = await fetch('/api/menus', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(menuData)
            });

            if (!response.ok) throw new Error('메뉴 추가 실패');

            loadMenus();
            event.target.reset();
        } catch (error) {
            console.error('메뉴 추가 중 오류 발생:', error);
        }
    }

    // 메뉴 수정 함수
    async function editMenu(menuId) {
        try {
            const response = await fetch(`/api/menus/${menuId}`);
            const menu = await response.json();
            
            // 수정 폼에 데이터 채우기
            document.getElementById('editMenuId').value = menu.id;
            document.getElementById('editMenuName').value = menu.name;
            document.getElementById('editMenuPrice').value = menu.price;
            document.getElementById('editMenuDescription').value = menu.description;
            document.getElementById('editMenuAvailable').checked = menu.available;
            
            // 수정 모달 열기
            document.querySelector('.menu-edit-modal').style.display = 'block';
        } catch (error) {
            console.error('메뉴 정보 로드 중 오류 발생:', error);
        }
    }

    // 메뉴 삭제 함수
    async function deleteMenu(menuId) {
        if (!confirm('메뉴를 삭제하시겠습니까?')) {
            return;
        }

        try {
            const response = await fetch(`/api/menus/${menuId}`, {
                method: 'DELETE'
            });

            if (!response.ok) {
                throw new Error('메뉴 삭제 실패');
            }

            loadMenus();
        } catch (error) {
            console.error('메뉴 삭제 중 오류 발생:', error);
        }
    }

    // 메뉴 수정 제출 함수
    async function submitMenuEdit(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const menuId = formData.get('id');
        const menuData = {
            name: formData.get('name'),
            price: parseInt(formData.get('price')),
            description: formData.get('description'),
            available: formData.get('available') === 'true'
        };

        try {
            const response = await fetch(`/api/menus/${menuId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(menuData)
            });

            if (!response.ok) {
                throw new Error('메뉴 수정 실패');
            }

            loadMenus();
            document.querySelector('.menu-edit-modal').style.display = 'none';
        } catch (error) {
            console.error('메뉴 수정 중 오류 발생:', error);
        }
    }

    let currentCategory = null;

    // 카테고리 버튼 클릭 이벤트 핸들러
    function handleCategoryClick(event) {
        const category = event.target.dataset.category;
        if (!category) return; // 관리 버튼 등은 처리하지 않음
        
        currentCategory = category;
        loadMenuByCategory(category);
        
        // 카테고리 버튼 스타일 업데이트
        document.querySelectorAll('.category-button').forEach(button => {
            button.classList.remove('active');
        });
        event.target.classList.add('active');
    }

    // 카테고리별 메뉴 로드 함수
    async function loadMenuByCategory(category) {
        try {
            const response = await fetch(`/api/menus?category=${category}`);
            const menus = await response.json();
            
            // 모든 메뉴 아이템 초기화
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.innerHTML = '';
                item.style.cursor = 'default';
            });
            
            // 받아온 메뉴 데이터로 메뉴 아이템 업데이트
            menus.forEach((menu, index) => {
                if (index < menuItems.length) {
                    menuItems[index].innerHTML = `
                        <div>${menu.name}</div>
                        <div>${menu.price}원</div>
                    `;
                    menuItems[index].style.cursor = 'pointer';
                    menuItems[index].onclick = () => addToOrder(menu);
                }
            });
        } catch (error) {
            console.error('메뉴 로드 중 오류 발생:', error);
        }
    }

    // 주문에 메뉴 추가 함수
    function addToOrder(menu) {
        // TODO: 주문 목록에 메뉴 추가 구현
        console.log('메뉴 추가:', menu);
    }

    // 카테고리 버튼에 클릭 이벤트 리스너 추가
    document.querySelectorAll('.category-button').forEach(button => {
        button.addEventListener('click', handleCategoryClick);
    });

    // 초기 로딩 시 첫 번째 카테고리 선택
    document.addEventListener('DOMContentLoaded', function() {
        const firstCategory = document.querySelector('.category-button');
        if (firstCategory) {
            firstCategory.click();
        }
    });

    // 카테고리 관리 함수들
    function openCategoryManageModal() {
        document.querySelector('.category-manage-overlay').style.display = 'block';
        document.querySelector('.category-manage-container').style.display = 'block';
        loadCategories();
        loadCategoryTypes();
    }

    function closeCategoryManageModal() {
        document.querySelector('.category-manage-overlay').style.display = 'none';
        document.querySelector('.category-manage-container').style.display = 'none';
    }

    async function loadCategories() {
        try {
            const response = await fetch('/api/categories');
            const categories = await response.json();
            
            const categoryTableBody = document.querySelector('.category-table tbody');
            categoryTableBody.innerHTML = '';
            
            categories.forEach(category => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${category.type}</td>
                    <td>${category.name}</td>
                    <td>${category.description || ''}</td>
                    <td>${category.status}</td>
                    <td>
                        <button onclick="editCategory(${category.id})">수정</button>
                        <button onclick="deleteCategory(${category.id})">삭제</button>
                    </td>
                `;
                categoryTableBody.appendChild(row);
            });
        } catch (error) {
            console.error('카테고리 로드 중 오류 발생:', error);
        }
    }

    async function loadCategoryTypes() {
        try {
            const response = await fetch('/api/categories/types');
            const types = await response.json();
            
            const typeSelect = document.querySelector('select[name="type"]');
            typeSelect.innerHTML = '<option value="">카테고리 타입 선택</option>';
            
            types.forEach(type => {
                const option = document.createElement('option');
                option.value = type;
                option.textContent = type;
                typeSelect.appendChild(option);
            });
        } catch (error) {
            console.error('카테고리 타입 로드 중 오류 발생:', error);
        }
    }

    async function loadCategoriesForSelect() {
        try {
            const response = await fetch('/api/categories');
            const categories = await response.json();
            
            const categorySelect = document.querySelector('select[name="category"]');
            categorySelect.innerHTML = '<option value="">카테고리 선택</option>';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                categorySelect.appendChild(option);
            });
        } catch (error) {
            console.error('카테고리 로드 중 오류 발생:', error);
        }
    }

    // 카테고리 추가/수정/삭제 함수들
    async function addCategory(event) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const categoryData = {
            type: formData.get('type'),
            name: formData.get('name'),
            description: formData.get('description'),
            status: formData.get('status') === 'ACTIVE' ? 'ACTIVE' : 'INACTIVE'
        };

        try {
            const response = await fetch('/api/categories', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(categoryData)
            });

            if (!response.ok) throw new Error('카테고리 추가 실패');

            loadCategories();
            loadAndDisplayCategories(); // UI 업데이트
            event.target.reset();
        } catch (error) {
            console.error('카테고리 추가 중 오류 발생:', error);
        }
    }

    async function deleteCategory(id) {
        if (!confirm('이 카테고리를 삭제하시겠습니까?')) return;

        try {
            const response = await fetch(`/api/categories/${id}`, {
                method: 'DELETE'
            });

            if (!response.ok) throw new Error('카테고리 삭제 실패');

            loadCategories();
            loadAndDisplayCategories(); // UI 업데이트
        } catch (error) {
            console.error('카테고리 삭제 중 오류 발생:', error);
        }
    }

    async function editCategory(id) {
        try {
            const response = await fetch(`/api/categories/${id}`);
            const category = await response.json();
            
            // 수정 폼에 데이터 채우기
            document.querySelector('select[name="type"]').value = category.type;
            document.querySelector('input[name="name"]').value = category.name;
            document.querySelector('textarea[name="description"]').value = category.description || '';
            document.querySelector('input[name="status"]').checked = category.status === 'ACTIVE';
            
            // 폼의 동작을 수정 모드로 변경
            const form = document.querySelector('.category-form');
            form.onsubmit = (e) => updateCategory(e, id);
            
            // 버튼 텍스트 변경
            form.querySelector('button[type="submit"]').textContent = '카테고리 수정';
            
            // 취소 버튼 추가
            if (!form.querySelector('.cancel-btn')) {
                const cancelBtn = document.createElement('button');
                cancelBtn.type = 'button';
                cancelBtn.className = 'cancel-btn';
                cancelBtn.textContent = '취소';
                cancelBtn.onclick = resetCategoryForm;
                form.appendChild(cancelBtn);
            }
        } catch (error) {
            console.error('카테고리 정보 로드 중 오류 발생:', error);
        }
    }

    async function updateCategory(event, id) {
        event.preventDefault();
        const formData = new FormData(event.target);
        const categoryData = {
            type: formData.get('type'),
            name: formData.get('name'),
            description: formData.get('description'),
            status: formData.get('status') === 'ACTIVE' ? 'ACTIVE' : 'INACTIVE'
        };

        try {
            const response = await fetch(`/api/categories/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(categoryData)
            });

            if (!response.ok) throw new Error('카테고리 수정 실패');

            loadCategories();
            loadAndDisplayCategories(); // UI 업데이트
            resetCategoryForm();
        } catch (error) {
            console.error('카테고리 수정 중 오류 발생:', error);
        }
    }

    function resetCategoryForm() {
        const form = document.querySelector('.category-form');
        form.reset();
        form.onsubmit = addCategory;
        form.querySelector('button[type="submit"]').textContent = '카테고리 추가';
        const cancelBtn = form.querySelector('.cancel-btn');
        if (cancelBtn) {
            cancelBtn.remove();
        }
    }

    // 페이지 로드 시 카테고리 로드
    document.addEventListener('DOMContentLoaded', function() {
        loadAndDisplayCategories();
    });

    // 카테고리 로드 및 표시 함수
    async function loadAndDisplayCategories() {
        try {
            const response = await fetch('/api/categories');
            const categories = await response.json();
            
            // 카테고리 버튼 컨테이너
            const firstRow = document.querySelector('.category-row:first-child');
            const secondRow = document.querySelector('.category-row:last-child');
            
            // 기존 카테고리 버튼 초기화 (관리 버튼 제외)
            firstRow.innerHTML = '';
            secondRow.innerHTML = '';
            
            // 첫 번째 줄에 6개, 두 번째 줄에 나머지 카테고리 배치
            categories.forEach((category, index) => {
                const button = document.createElement('div');
                button.className = 'category-button';
                button.dataset.category = category.type;
                button.dataset.categoryId = category.id;
                
                // 카테고리 이름이 긴 경우 줄바꿈 처리
                const displayName = category.name.length > 4 ? 
                    category.name.replace('/', '<br>') : category.name;
                button.innerHTML = displayName;
                
                button.addEventListener('click', handleCategoryClick);
                
                if (index < 6) {
                    firstRow.appendChild(button);
                } else if (index < 12) {
                    secondRow.appendChild(button);
                }
            });
            
            // 첫 번째 줄에 카테고리 관리 버튼 추가
            const categoryManageBtn = document.createElement('div');
            categoryManageBtn.className = 'category-button';
            categoryManageBtn.innerHTML = '카테고리<br>관리';
            categoryManageBtn.onclick = openCategoryManageModal;
            firstRow.appendChild(categoryManageBtn);
            
            // 두 번째 줄 남은 공간 채우기
            const remainingSlots = 6 - (categories.length - 6);
            for (let i = 0; i < remainingSlots; i++) {
                const emptyButton = document.createElement('div');
                emptyButton.className = 'category-button';
                secondRow.appendChild(emptyButton);
            }
            
            // 메뉴 관리 버튼 추가
            const menuManageBtn = document.createElement('div');
            menuManageBtn.className = 'category-button';
            menuManageBtn.innerHTML = '메뉴<br>관리';
            menuManageBtn.onclick = openMenuManageModal;
            secondRow.appendChild(menuManageBtn);
            
            // 첫 번째 카테고리 자동 선택
            const firstCategory = document.querySelector('.category-button[data-category]');
            if (firstCategory) {
                firstCategory.click();
            }
        } catch (error) {
            console.error('카테고리 로드 중 오류 발생:', error);
        }
    }
</script>

<!-- 메뉴 관리 모달 -->
<div class="menu-manage-overlay"></div>
<div class="menu-manage-container">
    <div class="menu-manage-header">
        <h2>메뉴 관리</h2>
        <button onclick="closeMenuManageModal()" class="close-btn">✕</button>
    </div>
    
    <div class="menu-manage-content">
        <!-- 메뉴 추가 폼 -->
        <form onsubmit="addMenu(event)" class="menu-form">
            <h3>새 메뉴 추가</h3>
            <input type="text" name="name" placeholder="메뉴명" required>
            <input type="number" name="price" placeholder="가격" required>
            <textarea name="description" placeholder="설명"></textarea>
            <select name="category" required>
                <option value="">카테고리 선택</option>
            </select>
            <label>
                <input type="checkbox" name="available" value="true" checked>
                판매 가능
            </label>
            <button type="submit">메뉴 추가</button>
        </form>

        <!-- 메뉴 목록 테이블 -->
        <div class="menu-table-container">
            <h3>메뉴 목록</h3>
            <table class="menu-table">
                <thead>
                    <tr>
                        <th>메뉴명</th>
                        <th>가격</th>
                        <th>카테고리</th>
                        <th>설명</th>
                        <th>상태</th>
                        <th>관리</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 메뉴 항목들은 JavaScript로 동적 추가 -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 메뉴 수정 모달 -->
<div class="menu-edit-modal">
    <div class="modal-content">
        <h2>메뉴 수정</h2>
        <form onsubmit="submitMenuEdit(event)">
            <input type="hidden" id="editMenuId" name="id">
            <input type="text" id="editMenuName" name="name" placeholder="메뉴명" required>
            <input type="number" id="editMenuPrice" name="price" placeholder="가격" required>
            <textarea id="editMenuDescription" name="description" placeholder="설명"></textarea>
            <label>
                <input type="checkbox" id="editMenuAvailable" name="available" value="true">
                판매 가능
            </label>
            <button type="submit">수정 완료</button>
            <button type="button" onclick="document.querySelector('.menu-edit-modal').style.display='none'">취소</button>
        </form>
    </div>
</div>

<!-- 카테고리 관리 모달 -->
<div class="category-manage-overlay"></div>
<div class="category-manage-container">
    <div class="category-manage-header">
        <h2>카테고리 관리</h2>
        <button onclick="closeCategoryManageModal()" class="close-btn">✕</button>
    </div>
    
    <div class="category-manage-content">
        <!-- 카테고리 추가 폼 -->
        <form onsubmit="addCategory(event)" class="category-form">
            <h3>새 카테고리 추가</h3>
            <select name="type" required>
                <option value="">카테고리 타입 선택</option>
            </select>
            <input type="text" name="name" placeholder="카테고리명" required>
            <textarea name="description" placeholder="설명"></textarea>
            <label>
                <input type="checkbox" name="status" value="ACTIVE" checked>
                활성화
            </label>
            <button type="submit">카테고리 추가</button>
        </form>

        <!-- 카테고리 목록 테이블 -->
        <div class="category-table-container">
            <h3>카테고리 목록</h3>
            <table class="category-table">
                <thead>
                    <tr>
                        <th>타입</th>
                        <th>이름</th>
                        <th>설명</th>
                        <th>상태</th>
                        <th>관리</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 카테고리 항목들은 JavaScript로 동적 추가 -->
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>